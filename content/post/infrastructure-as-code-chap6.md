+++
date = "2017-06-29T21:52:49+09:00"
slug = ""
tags = ["",""]
title = "Infrastructure as Code 感想 (6章)"

+++

オライリーの「Infrastructure as Code」を読んで思ったことや自分的メモをまとめておく．**太字は自分の感想**， _斜字体は本からの引用_ ，そのほかは本の要約など．

## サーバーのライフライクル
* サーバーテンプレートのパッケージング
* サーバーのデプロイ
* サーバーのアップデート(編集)
* サーバーの交換
    * サーバーのスケールアップ/ダウンのための再起動もこれに含める
* サーバーの削除

## サーバーに含まれるもの
* ソフトウェア
    * サーバーへインストールするもの
* 構成/設定
    * その構成情報/設定情報
* データ
    * ソフトウェアが生成・更新するファイル
    * ログファイルはここに含まれる
    * インフラストラクチャはデータの維持に責任を持つが，内容を管理はしない
* **インフラストラクチャはサーバのアップデート，交換，削除のプロセスを通して，一貫して「データ」へのアクセス性を提供しなければならない**
* _プロセスのさまざまな部分にかかる時間を計測するようにしなければならない_
    * **これはいろんなところに言えそう．次からは時間を計測することを考えるようにしよう**

## サーバーロールのパターン
* きめの細かいロールを定義し，それらを組み合わせてサーバを構成するパターン
* ロールの継承階層を作るパターン
    * OSの基本設定，監視エージェントなどは他のロールから継承されることになる

## サーバー作成のパターン
* ここは「テンプレートからの作成」一択．ただし，サーバー作成オプションはスクリプトでラッピングする
* アンチパターン
    * 手作りサーバー…無人実行のプラクティスに反する
    * 毎回編集しなければならないようなスクリプト…同上
    * ホットクローン…構成ドリフトの原因になる
    * スノーフレークファクトリ

## 新サーバーのブートストラップのパターン
* プッシュブートストラップ
    * SSHでログインするための特権IDが必要．クラウドによってはサーバー作成時にIDを発行できる．
* プルブートストラップ
    * ロールを新サーバーへ伝える必要がある．AWSのUser Dataとcloud-initの組み合わせなど．
* いずれにしてもプロビジョングしたサーバーは自動的にテストされなければならない

## 参考文献
1. Kief Morris, Infrastructure as Code クラウドにおけるサーバ管理の原則とプラクティス, 長尾高弘訳, オライリー・ジャパン, 2017
